@page "/Register"
@page "/Login"
@using MisProject.Client.Components.Identity
@inject NavigationManager _navigationManager

<PageTitle>احراز هویت</PageTitle>

<MudGrid Justify="Justify.Center">
    <MudItem xs="11" md="6" Class="mt-4">
        <MudCard>
            <MudCarousel @ref="_carousel" Style="@_height" ShowArrows="false" ShowDelimiters="false" AutoCycle="false" TData="object">

                <LoginCard NextCarouseAction="NextCarouseAction"/>
                <RegisterCard NextCarouseAction="NextCarouseAction"/>

            </MudCarousel>
        </MudCard>
    </MudItem>
</MudGrid>

@code {
    
    [CascadingParameter]
    private Task<AuthenticationState> AuthenticationState { get; } = null!;

    private string _height = "height: 350px";
    private MudCarousel<object> _carousel = new();

    protected override async Task OnInitializedAsync()
    {
        var state = await AuthenticationState;
        if (state.User.Identity is {IsAuthenticated: true })
            _navigationManager.NavigateTo("/"); // TODO: Change this to /profile
    }

    private void NextCarouseAction()
    {
        _carousel.Next();
        _height = 
            _height == "height: 350px" 
            ? "height: 650px" 
            : "height: 350px";
        StateHasChanged();
    }

}
